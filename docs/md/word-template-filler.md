# Word模板填充器（测试）

> 此工具目前处于测试阶段，功能可能不完善，欢迎反馈问题和建议。

## 这是什么

一个让你自己创建表单应用的工具。

你有一份Word模板，想让别人填写后导出？用这个工具，**自己配置一下就能生成一个独立的网页应用**。

生成的应用可以直接分发给别人用，填完导出的Word格式和原模板一模一样。

## 为什么做这个

Word格式这破事，字体错了、表格歪了、页眉没了，内容写得再好也得返工。多人填同一份Word，格式必乱。

这个工具就是为了不用再为格式浪费时间。

## 工作流程

```
Word模板 + Excel配置 → 上传到工具 → 生成独立HTML → 分发 → 导出格式统一的Word
```

## 快速开始

### 第一步：准备Word模板

在Word文档中，把需要填写的位置用 `{字段名}` 标记：

```
玩家ID：{playerId}
段位：{rank}
日期：{date}
```

保存为 `.docx` 格式。

### 第二步：准备Excel配置

新建Excel，第一个工作表命名为"字段配置"，填写：

| 字段名 | 显示名称 | 类型 | 选项 | 默认值 | 必填 | 提示 |
|--------|----------|------|------|--------|------|------|
| playerId | 玩家ID | 文本 | | | 是 | |
| rank | 段位 | 单选 | Bronze,Silver,Gold,Platinum,Diamond,Master,Grandmaster | | 是 | |
| date | 日期 | 日期 | | | 是 | |

保存为 `.xlsx` 格式。

### 第三步：生成应用

1. 打开Word模板填充器
2. 上传Excel配置文件
3. 上传Word模板文件
4. 填写应用名称
5. 点击"生成应用"
6. 下载压缩包，解压

### 第四步：使用

解压后把HTML和Word模板放在同一目录，浏览器打开HTML即可填写并导出Word。

---

## 详细配置说明

### 字段类型

| 类型 | 说明 | Word模板写法 |
|------|------|--------------|
| 文本 | 单行输入框 | `{字段名}` |
| 多行文本 | 多行文本域 | `{字段名}` |
| 日期 | 日期选择器 | `{字段名}` |
| 是否 | 是/否选择 | `{字段名Pass}` 和 `{字段名Fail}` |
| 单选 | 多选一 | `{字段名_选项值}` |
| 多选 | 可多选 | `{字段名_选项值}` |
| 列表 | 可添加多行 | `{#字段名}...{/字段名}` |

### 配置表列说明

| 列名 | 必填 | 说明 |
|------|------|------|
| 字段名 | 是 | 对应Word模板中的占位符，建议用英文 |
| 显示名称 | 否 | 表单中显示的标签，默认用字段名 |
| 类型 | 否 | 见上表，默认为文本 |
| 选项 | 单选/多选必填 | 用英文逗号分隔，如 `选项1,选项2,选项3` |
| 默认值 | 否 | 表单的初始值 |
| 必填 | 否 | 填"是"表示必填 |
| 提示 | 否 | 输入框的提示文字 |
| 格式 | 否 | 日期格式，如 `YYYY年MM月DD日` |
| 子表 | 列表类型必填 | 子字段所在的工作表名称 |
| 行数 | 否 | 多行文本的行数，默认3 |

---

## 各类型详解

### 是否类型

用于"是/否"、"吃鸡/落地成盒"这类二选一场景。

**Excel配置：**
| 字段名 | 显示名称 | 类型 |
|--------|----------|------|
| chickenDinner | 是否吃鸡 | 是否 |

**Word模板写法：**
```
本局结果：{chickenDinnerPass} 大吉大利今晚吃鸡  {chickenDinnerFail} 落地成盒
```

**效果：**
- 选"是"→ `☑ 大吉大利今晚吃鸡  □ 落地成盒`
- 选"否"→ `□ 大吉大利今晚吃鸡  ☑ 落地成盒`

### 单选类型

多个选项选一个。

**Excel配置：**
| 字段名 | 显示名称 | 类型 | 选项 |
|--------|----------|------|------|
| dropLocation | 跳伞地点 | 单选 | Pochinki,Military Base,School,Georgopol,Sosnovka |

**Word模板写法：**
```
跳伞地点：{dropLocation_Pochinki} P城  {dropLocation_Military Base} 军事基地  {dropLocation_School} 学校  {dropLocation_Georgopol} G港  {dropLocation_Sosnovka} 机场
```

**效果（选"Military Base"）：**
```
跳伞地点：□ P城  ☑ 军事基地  □ 学校  □ G港  □ 机场
```

### 多选类型

可以选多个选项。

**Excel配置：**
| 字段名 | 显示名称 | 类型 | 选项 |
|--------|----------|------|------|
| weapons | 使用武器 | 多选 | M416,AKM,AWM,Kar98k,UZI,S12K |

**Word模板写法：**
```
本局武器：{weapons_M416} M416  {weapons_AKM} AKM  {weapons_AWM} AWM  {weapons_Kar98k} Kar98k  {weapons_UZI} UZI  {weapons_S12K} S12K
```

**效果（选"M416"和"Kar98k"）：**
```
本局武器：☑ M416  □ AKM  □ AWM  ☑ Kar98k  □ UZI  □ S12K
```

### 列表类型

用于需要填写多条记录的场景，如击杀记录。

**第一步：主表配置**
| 字段名 | 显示名称 | 类型 | 子表 |
|--------|----------|------|------|
| kills | 击杀记录 | 列表 | 击杀明细 |

**第二步：新建工作表"击杀明细"**
| 字段名 | 显示名称 | 类型 |
|--------|----------|------|
| victimId | 对手ID | 文本 |
| weapon | 击杀武器 | 文本 |
| distance | 击杀距离 | 文本 |

**Word模板写法：**
```
击杀记录：
{#kills}
- {victimId}，武器：{weapon}，距离：{distance}m
{/kills}
```

**效果（填了3条记录）：**
```
击杀记录：
- xXx_Killer_xXx，武器：Kar98k，距离：380m
- NoobMaster69，武器：M416，距离：50m
- 落地成盒王，武器：平底锅，距离：2m
```

---

## 日期格式

日期类型可以通过"格式"列自定义输出格式：

| 格式 | 输出示例 |
|------|----------|
| YYYY年MM月DD日 | 2025年01月15日 |
| YYYY-MM-DD | 2025-01-15 |
| YYYY/MM/DD | 2025/01/15 |
| MM月DD日 | 01月15日 |

---

## 生成的文件

压缩包内容：
- `应用名称.html` - 填写页面，浏览器打开即用
- `document.docx` - Word模板
- `部署说明.txt` - 简要说明
- `配置备份.json` - 配置信息备份

---

## 注意事项

1. 占位符用英文花括号 `{}`，不是中文 `｛｝`
2. 字段名建议用英文，避免特殊字符
3. 单选/多选的选项用英文逗号分隔
4. HTML和Word模板必须放在同一目录
5. 推荐使用Chrome或Edge浏览器

---

## 技术说明

基于 docxtemplater 实现，纯前端运行，无需服务器。
